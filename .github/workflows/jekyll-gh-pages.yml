# name: Deploy to Page on Pull Request

# on:
#   push:
#     branches: ["main"]
#   # pull_request:
#   #   branches:
#   #     - main

# # permissions:
# #   contents: read
# #   pages: write
# #   id-token: write
      
# jobs:
#   # build:
#   #   runs-on: ubuntu-latest
#   #   steps:
#   #     - name: Checkout
#   #       uses: actions/checkout@v3
#   #     - name: Setup Pages
#   #       uses: actions/configure-pages@v3
#   #     - name: Build with Jekyll
#   #       uses: actions/jekyll-build-pages@v1
#   #       with:
#   #         source: ./
#   #         destination: ./_site
#   #     - name: Upload artifact
#   #       uses: actions/upload-pages-artifact@v2

#   # # Deployment job
#   # deploy:
#   #   environment:
#   #     name: github-pages
#   #     url: ${{ steps.deployment.outputs.page_url }}
#   #   runs-on: ubuntu-latest
#   #   needs: build
#   #   steps:
#   #     - name: Deploy to GitHub Pages
#   #       id: deployment
#   #       uses: actions/deploy-pages@v2  


        
#   build:
#     runs-on: ubuntu-latest

#     steps:
#     - name: Checkout code
#       uses: actions/checkout@v2

#     - name: Setup Node.js
#       uses: actions/setup-node@v2
#       with:
#         node-version: '18' # Puedes ajustar la versión de Node.js según tus necesidades

#     - name: Install Dependencies
#       run: npm install

#     - name: Deploy with gh-pages
#       run: |
#         git remote set-url origin https://git:${GITHUB_TOKEN}@github.com/${GITHUB_REPOSITORY}.git
#         npm run deploy -- -u "github-actions-bot <support+actions@github.com>"
#       env:
#         GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
#     # - name: Deploy to Page
#     #   run: npm run deploy
#     # - name: Deploy
#     #   run: |
#     #     echo 'felipe'
#     #     echo ${github_token}
#     #     echo ${repository}
#     #     git config --global user.name $user_name
#     #     echo condifure user_name: $user_name
#     #     git config --global user.email $user_email
#     #     echo condifure user_email: $user_email
#     #     git remote set-url origin https://${github_token}@github.com/${repository}
#     #     echo configure origin https://${github_token}@github.com/${repository}
#     #     npm run deploy
#     #   env:
#     #     user_name: 'vegueta01'
#     #     user_email: 'felipe.buitrago.betancourt@gmail.com'
#     #     github_token: ${{ secrets.TOKEN_GITHUB }}
#     #     repository: ${{ github.repository }}


#   # deploy:
#   #   # Add a dependency to the build job
#   #   needs: build

#   #   # Grant GITHUB_TOKEN the permissions required to make a Pages deployment
#   #   permissions:
#   #     pages: write      # to deploy to Pages
#   #     id-token: write   # to verify the deployment originates from an appropriate source

#   #   # Deploy to the github-pages environment
#   #   environment:
#   #     name: github-pages
#   #     url: 'http://vegueta01.github.io/jerson-alcalde'
     
#   #   # Specify runner + deployment step
#   #   runs-on: ubuntu-latest

#   #   steps:
#   #     - name: logs
#   #       run: |
#   #         echo steps.deployment.outputs.page_url: ${{ steps.deployment.outputs.page_url }}

#   #     - name: Deploy to GitHub Pages
#   #       id: deployment
#   #       uses: actions/deploy-pages@v2 # or the latest "vX.X.X" version tag for this action
#   #       with:
#   #         artifact_name: dist

# This workflow will do a clean installation of node dependencies, cache/restore them, build the source code and run tests across different versions of node
# For more information see: https://docs.github.com/en/actions/automating-builds-and-tests/building-and-testing-nodejs

name: Node.js CI

on:
  push:
    branches: [ "main" ]
  # pull_request:
  #   branches: [ "main" ]

jobs:
  build:

    runs-on: ubuntu-latest

    strategy:
      matrix:
        node-version: [18.x]
        # See supported Node.js release schedule at https://nodejs.org/en/about/releases/

    steps:
    - uses: actions/checkout@v3
    - name: Use Node.js ${{ matrix.node-version }}
      uses: actions/setup-node@v3
      with:
        node-version: ${{ matrix.node-version }}
        cache: 'npm'
    - run: npm ci
    - run: npm run build --if-present
    - name: Deploy with gh-pages
      run: |
        git config --global user.email "felipe.buitrago.betancourt@gmail.com"
        git config --global user.name "Felipe"
        git remote set-url origin https://git:${GITHUB_TOKEN}@github.com/${GITHUB_REPOSITORY}.git
        npm run deploy
      env:
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}